<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE workflow PUBLIC "-//OpenSymphony Group//DTD OSWorkflow 2.8//EN" "http://www.opensymphony.com/osworkflow/workflow_2_8.dtd">
<workflow>
	<meta name="created">Thu Jan 15 13:53:24 CET 2009</meta>
	<meta name="lastModified">Thu Jan 15 14:09:30 CET 2009</meta>
	<meta name="generator">OSWorkflow Designer</meta>
	<initial-actions>
		<action id="1" name="Start Workflow">
			<results>
				<unconditional-result id="5" old-status="Finished"
					status="Queued" step="2" />
			</results>
		</action>
	</initial-actions>
	<steps>
		<step id="2" name="workflowInitialized">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.JustFillPropertyFunction
					</arg>
					<arg name="comment">Static comment</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="51" name="collect resources"
					view="collect resources" auto="true">
					<results>
						<unconditional-result id="52"
							old-status="Finished" status="Queued" step="50" />
					</results>
				</action>
			</actions>
		</step>

		<step id="50" name="resourcesCollected">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.SelectFileRecursivelyFunction
					</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="28" name="lock resources"
					view="lock resources" auto="true">
					<results>
						<unconditional-result id="29"
							old-status="Finished" status="Queued" step="3" />
					</results>
				</action>
			</actions>
		</step>


		<step id="3" name="resourcesLocked">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.ChangeLockOnResourcesFunction
					</arg>
					<arg name="lockValue">true</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="8" name="move resources to Staging"
					view="move resources to Staging" auto="true">
					<results>
						<unconditional-result id="9"
							old-status="Finished" status="Queued" step="30" />
					</results>
				</action>
			</actions>
		</step>


		<step id="30" name="movedToStaging">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.MoveToProjectFunction
					</arg>
					<arg name="destination">Staging</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="31" name="send notification"
					view="send notification" auto="true">
					<results>
						<unconditional-result id="32"
							old-status="Finished" status="Queued" step="4" />
					</results>
				</action>
			</actions>
		</step>


		<step id="4" name="notificationSent">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.EmailNotificationFunction
					</arg>
					<arg name="receivers">
						s.bianco@eurelis.com;sebastien.bianco@gmail.com;opencms:reviewer
					</arg>
					<arg name="comment">Other static comment</arg>
					<arg name="actor">Me</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="11" name="Validate" view="Validate">
					<results>
						<unconditional-result id="12"
							old-status="Finished" status="Queued" step="10" />
					</results>
				</action>
				<action id="14" name="Reject" view="Reject">
					<results>
						<unconditional-result id="15"
							old-status="Finished" status="Queued" step="13" />
					</results>
				</action>
			</actions>
		</step>


		<step id="10" name="validationOK">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.JustFillPropertyFunction
					</arg>
					<arg name="comment">Another static comment</arg>
					<arg name="actor">Everybody</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="25" name="publish Project"
					view="publish Project" auto="true">
					<results>
						<unconditional-result id="26"
							old-status="Finished" status="Queued" step="40" />
					</results>
				</action>
			</actions>
		</step>


		<step id="13" name="validationKO">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.JustFillPropertyFunction
					</arg>
					<arg name="actor">Me</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="18" name="move resources to Offline"
					view="moveResource" auto="true">
					<results>
						<unconditional-result id="19"
							old-status="Finished" status="Queued" step="17" />
					</results>
				</action>
			</actions>
		</step>

		<step id="17" name="resourceMovedToOfflineProject">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.MoveToProjectFunction
					</arg>
					<arg name="destination">Offline</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="21" name="unlock resources"
					view="unlockResource" auto="true">
					<results>
						<unconditional-result id="22"
							old-status="Finished" status="Queued" step="20" />
					</results>
				</action>
			</actions>
		</step>


		<step id="20" name="resourceUnlocked">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.ChangeLockOnResourcesFunction
					</arg>
					<arg name="lockValue">false</arg>
				</function>
			</pre-functions>
		</step>

		<step id="40" name="resourceMovedToOfflineProject">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.MoveToProjectFunction
					</arg>
					<arg name="destination">Offline</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="41" name="publish resources"
					view="publish Resource" auto="true">
					<results>
						<unconditional-result id="42"
							old-status="Finished" status="Queued" step="16" />
					</results>
				</action>
			</actions>
		</step>

		<step id="43" name="resource Unlocked">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.ChangeLockOnResourcesFunction
					</arg>
					<arg name="lockValue">false</arg>
				</function>
			</pre-functions>
			<actions>
				<action id="44" name="publish resources"
					view="publish Resource" auto="true">
					<results>
						<unconditional-result id="45"
							old-status="Finished" status="Queued" step="16" />
					</results>
				</action>
			</actions>
		</step>

		<step id="16" name="resourcePublished">
			<pre-functions>
				<function type="class">
					<arg name="class.name">
						com.eurelis.opencms.workflows.functions.PublishResourcesFunction
					</arg>
				</function>
			</pre-functions>
		</step>

	</steps>

</workflow>
